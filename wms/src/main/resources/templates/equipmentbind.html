<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="UTF-8">
		<meta name="renderer" content="webkit">
  		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>网站后台管理模版</title>
		<link rel="stylesheet" type="text/css" href="../static/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="../static/css/admin.css"/>

		<link rel="stylesheet" href="../static/css/zTreeStyle/zTreeStyle.css" type="text/css">
	</head>
	<body>
	<form class="layui-form column-content-detail">
					<div class="layui-tab">
						<ul class="layui-tab-title">
							<li class="layui-this">设备信息</li>
<!--							<li>SEO优化</li>-->
						</ul>
						<div class="layui-tab-content">
							<div class="layui-tab-item layui-show" style="height: 300px;">
								<div class="layui-form-item" style="display: none;">
									<label class="layui-form-label">行数：</label>
									<div class="layui-input-block">
										<input id="rowCounts" type="text" name="rowCounts" required lay-verify="required" th:value="${rowCounts}" autocomplete="off" class="layui-input">
									</div>
								</div>
								<div class="layui-form-item" style="display: none;">
									<label class="layui-form-label">列数：</label>
									<div class="layui-input-block">
										<input id="columnCounts" type="text" name="columnCounts" required lay-verify="required" th:value="${columnCounts}" autocomplete="off" class="layui-input">
									</div>
								</div>


<!--								<div class="layui-btn-container">-->
<!--									<button class="layui-btn layui-btn-sm"     id="getChecked" >勾选指定节点</button>-->
<!--								</div>-->

								<div class="content_wrap">
									<div class="zTreeDemoBackground left">
										<ul id="treeDemo" class="ztree"></ul>
									</div>
								</div>


<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">设备等级：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<select name="equipmentGrade" lay-verify="required">-->
<!--											<option value="">请选择级别</option>-->
<!--											<option value="1">一级</option>-->
<!--											<option value="2">二级</option>-->
<!--										</select>-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">分类栏目：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<select name="equipmentClass" lay-verify="required" id = "classEquipmentSelect">-->
<!--												<option value="">请选择分类</option>-->
<!--												<option value="0">战术装备箱</option>-->
<!--												<option value="1">布控球</option>-->
<!--												<option value="2">手持终端设备</option>-->
<!--										</select>-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">图像上传：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="file" name="file" class="layui-upload-file">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">是否生效：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="checkbox" name="label[tj]" title="推荐" checked>-->
<!--										<input type="checkbox" name="label[zd]" title="置顶">-->
<!--										<input type="checkbox" name="label[hot]" title="热门">-->
<!--									</div>-->
<!--								</div>-->

<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">是否生效：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="checkbox" name="validState" lay-skin="switch" checked="checked">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">上级设备：</label>-->
<!--									<div class="layui-input-block">-->
<!--										&lt;!&ndash;										<textarea class="layui-textarea layui-hide" name="content" lay-verify="content" id="LAY_demo_editor"></textarea>&ndash;&gt;-->
<!--										<input type="text" name="equipmentPreId" placeholder="请输入上级设备Id" autocomplete="off" class="layui-input">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">公司ID：</label>-->
<!--									<div class="layui-input-block">-->
<!--&lt;!&ndash;										<textarea class="layui-textarea layui-hide" name="content" lay-verify="content" id="LAY_demo_editor"></textarea>&ndash;&gt;-->
<!--										<input type="text" name="equipmentCompanyId" required lay-verify="required" placeholder="请输入公司Id" autocomplete="off" class="layui-input">-->
<!--									</div>-->
<!--								</div>-->

<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">公司名称：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="text" name="equipmentCompanyName" required lay-verify="required" placeholder="请输入公司名称来源" autocomplete="off" class="layui-input">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">文章排序：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="text" name="listorder" required lay-verify="required" placeholder="请输入排序" autocomplete="off" class="layui-input" value="100">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">点击数：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="text" name="count" required lay-verify="required" placeholder="请输入文章点击数" autocomplete="off" class="layui-input" value="100">-->
<!--									</div>-->
<!--								</div>-->
							</div>
<!--							<div class="layui-tab-item">-->
<!--								<div class="layui-form-item">-->
<!--									<label class="layui-form-label">关键字：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<input type="text" name="laiyuan" placeholder="请输入关键字" autocomplete="off" class="layui-input">-->
<!--									</div>-->
<!--								</div>-->
<!--								<div class="layui-form-item layui-form-text">-->
<!--									<label class="layui-form-label">描述：</label>-->
<!--									<div class="layui-input-block">-->
<!--										<textarea placeholder="请输入内容" class="layui-textarea"></textarea>-->
<!--									</div>-->
<!--								</div>-->
<!--							</div>-->
						</div>
					</div>
<!--					<div class="layui-form-item" style="padding-left: 10px;">-->
<!--						<div class="layui-input-block">-->
<!--							<button class="layui-btn layui-btn-normal" id="equipmentBindForm" lay-filter="equipmentBindForm">立即提交</button>-->
<!--&lt;!&ndash;							<button type="reset" class="layui-btn layui-btn-primary">取消</button>&ndash;&gt;&lt;!&ndash;lay-submit&ndash;&gt;-->
<!--						</div>-->
<!--					</div>-->
				</form>
	<script src="../static/layui/layui.js" type="text/javascript" charset="utf-8"></script>

	<script type="text/javascript" src="../static/js/ztree/jquery-1.4.4.min.js"></script>
<!--	<script type="text/javascript" src="../static/js/ztree/jquery.ztree.core.js"></script>-->
	<script type="text/javascript" src="../static/js/ztree/jquery.ztree.all.js"></script>
<!--	<script src="../static/js/module/common.js" type="text/javascript" charset="utf-8"></script>-->
<!--	<script src="../static/layui/lay/modules/eleTree.js" type="text/javascript" charset="utf-8"></script>-->
<!--	<script src="../static/js/equipment/equipment-operate.js" type="text/javascript" charset="utf-8"></script>-->
	<script>
		// layui.use(['jquery','from'], function() {
		// 	var form = layui.form,
		// 		$ = layui.jquery;
		//
		// 	var zTree = $.fn.zTree.getZTreeObj("treeDemo");
		// 	zTree.checkNode(treeNode, !treeNode.checked, null, true);
		//
		// 	//新增装备提交
		// 	form.on('submit(equipmentBindForm)', function (data) {
		//
		// 		let articleFrom = data.field;
		// 		if (articleFrom.equipmentClass == null || articleFrom.equipmentClass == ""){
		// 			articleFrom.equipmentClassName = "";
		// 		}else {
		// 			articleFrom.equipmentClassName = $("#classEquipmentSelect option:selected").text();
		// 		}
		// 		console.info(JSON.stringify(articleFrom));
		// 		$.ajax({
		// 			url: '/wms/equipmentIncrease',
		// 			type: 'post',
		// 			data: JSON.stringify(articleFrom),
		// 			dataType: "JSON",
		// 			async: true,
		// 			processData: false,	//不处理发送的数据
		// 			contentType: 'application/json',
		// 			success: function (result) {
		// 				// if (result.code == 100) {
		// 				//     layer.msg('登录成功', {
		// 				//         icon : 6,
		// 				//         time : 1000,
		// 				//         shade : 0.3,
		// 				//         end : function() {
		// 				//             location.href = "./index.html";
		// 				//         }
		// 				//     });
		// 				// } else if (result.code == 101) {
		// 				//     $("#password").focus();
		// 				// }
		//
		// 				layer.msg(result.msg);
		// 			},
		// 			error: function (error) {
		// 				layer.msg('系统错误' + error);
		// 			}
		// 		});
		//
		// 		return false;
		//
		// 	});
		// });

		var setting = {
			check: {
				enable: true,
				chkStyle: "radio",
				radioType: "all"
			},
			view: {
				dblClickExpand: false
			},
			data: {
				simpleData: {
					enable: true
				}
			},
			callback: {
				onClick: onClick,
				onCheck: onCheck
			}
		};

		function bindCallback () {

			var rowCounts = $("#rowCounts").val();
			var columnCounts = $("#columnCounts").val();

			var zTree = $.fn.zTree.getZTreeObj("treeDemo");
			var nodes = zTree.getSelectedNodes();
			var data = {};

			// for (var i=0, l=nodes.length; i<l; i++) {
			data.name = nodes[0].name;
			data.pId = nodes[0].pId;
			data.id = nodes[0].id;
			data.rowCounts = rowCounts;
			data.columnCounts = columnCounts;
			return data;
			// }
			// 		$.ajax({
			// 			url: '/wms/equipmentIncrease',
			// 			type: 'post',
			// 			data: JSON.stringify(articleFrom),
			// 			dataType: "JSON",
			// 			async: true,
			// 			processData: false,	//不处理发送的数据
			// 			contentType: 'application/json',
			// 			success: function (result) {
			// 				// if (result.code == 100) {
			// 				//     layer.msg('登录成功', {
			// 				//         icon : 6,
			// 				//         time : 1000,
			// 				//         shade : 0.3,
			// 				//         end : function() {
			// 				//             location.href = "./index.html";
			// 				//         }
			// 				//     });
			// 				// } else if (result.code == 101) {
			// 				//     $("#password").focus();
			// 				// }
			//
			// 				layer.msg(result.msg);
			// 			},
			// 			error: function (error) {
			// 				layer.msg('系统错误' + error);
			// 			}
			// 		});

		};

		function onClick(e, treeId, treeNode) {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo");
			zTree.checkNode(treeNode, !treeNode.checked, null, true);
			if (treeNode.pId ==null || treeNode.pId == 0){
				alert("无法选择公司层级，请重选");
				return false;
			}
			return false;
		}

		function onCheck(e, treeId, treeNode) {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo"),
					nodes = zTree.getCheckedNodes(true),
					v = "";
			for (var i=0, l=nodes.length; i<l; i++) {
				v += nodes[i].name + ",";
			}
			if (v.length > 0 ) v = v.substring(0, v.length-1);
			var cityObj = $("#citySel");
			cityObj.attr("value", v);
		}

		function showMenu() {
			var cityObj = $("#citySel");
			var cityOffset = $("#citySel").offset();
			$("#menuContent").css({left:cityOffset.left + "px", top:cityOffset.top + cityObj.outerHeight() + "px"}).slideDown("fast");

			$("body").bind("mousedown", onBodyDown);
		}
		function hideMenu() {
			$("#menuContent").fadeOut("fast");
			$("body").unbind("mousedown", onBodyDown);
		}
		function onBodyDown(event) {
			if (!(event.target.id == "menuBtn" || event.target.id == "citySel" || event.target.id == "menuContent" || $(event.target).parents("#menuContent").length>0)) {
				hideMenu();
			}
		}

		$(function () {

			$.ajax({
				url: '/wms/equipmentZtree',
				type: 'post',
				// data: JSON.stringify(articleFrom),
				dataType: "JSON",
				async: true,
				processData: false,	//不处理发送的数据
				contentType: 'application/json',
				success: function (data) {
					var jsondata = JSON.parse(data);
					if (jsondata.errorFlag) {
						layer.msg("" + jsondata.errMsg, { icon: 5 });
					} else {
						var zNodes = jsondata.data;//获取数据源

						$.fn.zTree.init($("#treeDemo"), setting, zNodes);
						// initSelectTree("PDEPT_KEY", true, { "Y": "ps", "N": "s" }, zNodes);
						// var treeObj = $.fn.zTree.getZTreeObj("PDEPT_KEYTree");
						// var node = treeObj.getNodes();
						// treeObj.selectNode(node[0]);
						// treeObj.checkNode(node[0], true, true, true);
					}
					// layer.msg(result.msg);
				},
				error: function (error) {
					// layer.msg('系统错误' + error);
				}
			});
			// $.ajax("/BindCombox/GetDeptData", false, "POST", {}, function (data) {
			// 	var jsondata = JSON.parse(data);
			// 	if (jsondata.IsError) {
			// 		layer.msg("" + jsondata.ErrMsg, { icon: 5 });
			// 	} else {
			// 		zNodes = jsondata.Data;//获取数据源
			//
			//
			// 		initSelectTree("PDEPT_KEY", true, { "Y": "ps", "N": "s" }, zNodes);
			// 		var treeObj = $.fn.zTree.getZTreeObj("PDEPT_KEYTree");
			// 		var node = treeObj.getNodes();
			// 		treeObj.selectNode(node[0]);
			// 		treeObj.checkNode(node[0], true, true, true);
			// 	}
			// });
		});
	</script>
	</body>
</html>